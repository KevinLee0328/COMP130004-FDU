## Online Judge

### #1

**阶乘**

Description

输入一个数N，请计算这个数的阶乘对10^9+7取模的结果

Input

输入一行仅一个数，表示N,N不超过10^6

Output

输出一行仅一个数，表示N的阶乘对10^9+7取模的结果

Sample Input 1 

```
5
```

Sample Output 1

```
120
```

### #2

**通关**

Description

小明最近发现了两个很好玩的游戏，但是他的业余时间并不多，每个游戏都有若干关卡，并且每个游戏只有在完成前一个关卡后才能完成下一个关卡，但两个游戏互相不会影响。

举个例子，小明必须完成第一个游戏的第一关之后才可以完成第一个游戏的第二关，完成前两关后才可以完成第三关，但是第二个游戏并不会影响第一个游戏的通关进度，反之亦然。

现在告诉你小明一共有多少业余时间以及他完成每个游戏的每个关卡分别需要多长时间，请帮他找出他最多能完成多少关

Input

输入第一行两个数N,T, 表示每个游戏的关卡数以及小明的总业余时间，其中，N不超过100，T不超过1000

接下来两行，每行N个数，分别表示每个游戏每一关所需要的时间，每关所需时间不超过100

Output

输出一行表示小明最多完成的总关数即可

Sample Input 1 

```
5 15
1 2 3 4 5
2 3 1 1 1
```

Sample Output 1

```
8
```

### #3

**合并**

Description

有两个递增的整数数组a1和a2，各自的元素个数为m，n。

请按照同样的递增顺序（非递减）排列，并输出排列后的各个元素

Input

第一行是两个数组的长度m和n，用空格隔开

第二行为第一个数组元素，用空格隔开

第三行为第二个数组元素，用空格隔开

Output

两个数组合并的结果，输出格式是一行由空格隔开的数

Sample Input 1 

```
3 3
1 2 3 
2 5 6
```

Sample Output 1

```
1 2 2 3 5 6
```

### #4

**共同元素**

Description

输入两个整数数组a1，a2，请输出两数组的共同的元素。返回结果中每个元素出现的次数，应与元素在两个数组中都出现的次数一致（如果出现次数不一致，则考虑取较小值）。输出结果按照非递减顺序排序。

Input

第一行是两个数组长度m和n，用空格隔开

第二行是数组a1的元素读入，用空格隔开

第三行是数组a2的元素读入，用空格隔开

Output

共同元素输出，用空格隔开，输出结果按照非递减顺序排序。

Sample Input 1 

```
4 2
1 2 2 1
2 2
```

Sample Output 1

```
2 2
```

### #5

**最大值-small**

Description

给出n个数A_i和一个滑动窗口的大小w，那么这个滑动窗口可以在这个数组上滑动n-w+1次，请你输出这个滑动窗口在这个数组上从头滑到尾的每个位置上时，这个窗口中的最大值。

0&lt;w&lt;n&lt;1000

A_i&lt;1000

Input

输入第一行两个是n,w，分别表示数组长度和滑动窗口长度。

第二行包含n个数，表示数组A_i

Output

输出共一行，n-w+1个数由空格隔开，分别表示滑动窗口在每个位置的最大值。

Sample Input 1 

```
10 3
3 9 7 4 6 5 1 2 8 10
```

Sample Output 1

```
9 9 7 6 6 5 8 10
```

### #6

**最大值-large**

Description

给出n个数A_i和一个滑动窗口的大小w，那么这个滑动窗口可以在这个数组上滑动n-w+1次，请你输出这个滑动窗口在这个数组上从头滑到尾的每个位置上时，这个窗口中的最大值。

0&lt;w&lt;n&lt;1000000

A_i&lt;1000000000

Input

输入第一行两个是n,w，分别表示数组长度和滑动窗口长度。

第二行包含n个数，表示数组A_i

Output

输出共一行，n-w+1个数由空格隔开，分别表示滑动窗口在每个位置的最大值。

Sample Input 1 

```
10 3
3 9 7 4 6 5 1 2 8 10
```

Sample Output 1

```
9 9 7 6 6 5 8 10
```

Hint

本题仅数据范围与small版本不同，样例仅供参考，实际测试数据较大，请注意设计算法的时间复杂度

### #7

**替换**

Description

给出一个字符串s，请你用目标字符串target替换从索引index开始的子字符串source。

要完成每次替换操作，首先检查子字符串source是否出现在s的index处。如果没有出现，什么也不做；如果出现，则用target替换source。

例如，如果s="abcd"，index=0，source="ab"，target="eee"，那么替换的结果将是"eeecd"。

注意所有替换操作同时发生，每次替换操作都在原字符串s上进行。测试用例保证元素间不会重叠。

Input

输入第一行包含一个字符串s和一个数n，表示原字符串和替换次数，用空格隔开。

接下来n行，每行包含一个数和两个字符串，分别表示index，source和target，用空格隔开。

Output

输出一行替换后的字符串。

Sample Input 1 

```
abcd 2
0 ab eee
2 ec ffff
```

Sample Output 1

```
eeecd
```

Hint

"ab" 从 s 中的索引 0 开始，所以它被替换为 "eee"。

"ec" 没有从原始 s 中的索引 2 开始，所以它没有被替换。

### #8

**比赛**

Description

N个小朋友排成一队，每个小朋友手中拿着一张整数牌，所有牌上的数字没有重复。现在小朋友们要进行比大小的游戏，每个回合都比较队伍开头两个小朋友的数字，牌上数字较大的小朋友会取得这一回合的胜利并且站到队首，数字较小的小朋友移到队尾。当某个小朋友连续赢得K个回合时游戏结束，这个小朋友就是比赛的赢家，请你输出这个小朋友牌上的数字。

Input

输入第一行包含两个整数N，K，分别表示小朋友的个数和赢得比赛需要的连续回合数。其中，1<N<100000，0<K<10000。

第二行包含N个整数，表示初始队伍中小朋友们牌上的数字。

Output

输出一行仅一个数，表示赢得比赛的小朋友牌上的数字。

Sample Input 1 

```
7 2
2 1 3 5 4 6 7
```

Sample Output 1

```
5
```

Hint

第一回合：2 1 3 5 4 6 7；获胜整数：2；连胜回合数：1

第二回合：2 3 5 4 6 7 1；获胜整数：3；连胜回合数：1

第三回合：3 5 4 6 7 1 2；获胜整数：5；连胜回合数：1

第四回合：5 4 6 7 1 2 3；获胜整数：5；连胜回合数：2

牌上数字是5的小朋友已经连胜2回合，赢得比赛。

### #9

**小明猜数字**

Description

小明和小武在家里开始了猜数字游戏，他们每个人纸上连续写下一串数字，小明说我能知道你写的是什么数字，并且为了证明我说的是对的，我会把你的这串连续数字隐藏在我的数字里面。小武觉得这根本不可能，于是他费劲心思写了一串非常罕见的数字。现在他们都已经写好了并把纸交给你，让你来揭晓小明是否能展现奇迹，若可以请告诉小武他的这串数字出现在小明这串数字里的位置。或许机智的小明在多个位置都隐藏了这串数字，方便起见可以直接告诉小武最先出现的位置。若不能，请你告诉小明让他不要再吹牛了。

Input

两个数N和M，分别代表小明和小武的数字个数，0 < N, M <= 100000

接下来一行N个数，代表小明的数字

接下来一行M个数，代表小武的数字

Output

若小武的数字串出现在小明数字串中，请给出最先在小明串中出现的位置

若没有出现，输出-1

Sample Input 1 

```
5 3
2 1 4 5 3
1 4 5
```

Sample Output 1

```
2
```

### #10

**简单的代数学**

Description

在新学期，小明学到了二次方程的解法，为了锻炼自己的能力，他给自己出了很多方程，但是自己出的题并没有答案，你能帮帮他吗？

Input

输入一行字符串，长度不超过200，为f(x)=g(x)的形式，即一个等式，等式两个各为一个多项式，多项式包含数字、加减运算符、数字、未知数x以及次数符号^。保证每一项只会有三种形式，即Ax^2, Ax, A，为了简化问题，即使未知数系数为1，或者第一项系数为正数，也不会省略系数或者系数前面的加减（正负）符号（详见样例），且A的绝对值只可能为1-9之间的整数，但是可能一边会存在多个相同次数的项。注意，在移项后，可能会消去所有二次项或一次项，但保证不会消去所有未知数。

Output

若方程无解，则输出"No solution"

若方程仅有一个解或有两个相同解，则输出一行为该解。

若方程有两个不同的解，则输出两行，每行一个解，从小到大排列。

输出的解为实数形式，保留两位小数。

Sample Input 1 

```
+1x^2=+9
```

Sample Output 1

```
-3.00
3.00
```

Hint

为避免输出精度问题，建议使用 double及 printf("%.2lf\n", answer)的形式进行答案输出。

评测时会打开O2编译优化选项，所以请尽量使用double存储系数等中间变量，否则可能会出现本地与评测结果不一致的情况。

在判断一个实数x是否为0时，请使用fabs(x)<1e-10的形式，否则可能会由于存储精度原因导致判断错误。

### #11

**得分总和**

Description

小明在按照一棵二叉树走路，每到一个节点会得到相应的得分，需要最后积分等于目标得分t。小明每次从根节点出发，要走到叶子节点，有多少种走法可以达成目标积分

Input

第一行是节点数n

第二行是从根节点开始的二叉树节点，按照满二叉树的层序遍历读入，树中节点总数在范围[0, 5000]内，-1000 <= Node.val <= 1000

第三行是目标得分，-1000 <= 目标得分 <= 1000

Output

返回的每一行，是从根节点开始的路径上的节点

有几条路径就返回几行，多条路径按照先左子树后右边子树的顺序输出

Sample Input 1 

```
15
5 4 8 3 11 13 4 2 1 7 2 3 1 5 1
22
```

Sample Output 1

```
5 4 11 2
5 8 4 5
```

Hint

sample中的二叉树如下图所示

![image.png](https://webvpn.fudan.edu.cn/http/77726476706e69737468656265737421a1a70fcd706726052746d8fdca/public/upload/c9ae24a49c.png)

### #12

**小明散步**

Description

小明在散步，这条路上每向前一步，到达的新的位置都限制了前进的最大步数，小明想要在规定的最大步数内到达一条路的终点，已知路的长度和每次要走的最大步数，请问小明能恰好到达终点吗（也就是数组的最后一个位置）？

Input

第一行输入路的长度m，也即数组长度，m<=10000

第二行输入每个位置最多可以走的步数，用空格隔开，步数不超过10000

Output

返回能否恰好到达终点：1表示能，0表示不能

Sample Input 1 

```
5
2 3 1 1 4
```

Sample Output 1

```
1
```

Hint

比如sample中到达终点的方法是：先走一步，到达第二个位置，第二个位置最大步数是3，则从该位置走3步，到终点

### #13

**二叉树遍历**

Description

小明在做数据结构的作业，其中一题是给你一棵二叉树的前序遍历和中序遍历结果，要求你写出这棵二叉树的后序遍历结果。

Input

输入包含多组测试数据。每组输入包含两个字符串，分别表示二叉树的前序遍历和中序遍历结果。每个字符串由不重复的大写字母组成。

Output

对于每组输入，输出对应的二叉树的后续遍历结果。

Sample Input 1 

```
DBACEGF ABCDEFG
BCAD CBAD
```

Sample Output 1

```
ACBFGED
CDAB
```

Hint

对于多组输入数据，可以使用以下方式读入

while (cin >> s1 >> s2) {

do_something();

}

在循环中进行二叉树的复原和输出操作即可。

注意，输入文件的文末没有多余空行。

### #14

**完全二叉树**

Description

假如对二叉树T和具有相同高度的满二叉树编号，如果T与满二叉树相同编号的节点位置相同，那么称二叉树T是一棵完全二叉树。现在根据边的连接情况判断一棵树是否是完全二叉树。

Input

第一行有2个整数n(0 < n < 1024)和r(1<=r<=n), 表示结点数和树根，接下来n-1行每行有2个整数a,b (1 <= a,b <= n)表示a结点和b结点有一条边相连，如果a是b的根结点，则b是a的左子结点，如果b是a的根结点，则a是b的右子结点（数据保证是一棵树而不是一座森林)

注意，这里不保证二叉树的结点是按顺序标记，也不保证二叉树的根节点为1

Output

如果是完全二叉树 输出yes 否则输出no

Sample Input 1 

```
5 1
1 2
3 1
4 2
2 5
```

Sample Output 1

```
yes
```

Hint

输入边的顺序没有保证，但保证合法，即从根节点开始可以构造出一棵唯一的二叉树，但是根节点所涉及的边可能出现在任意一行，建议读完所有数据之后再进行建树。

边的实际标号和检验树是否为完全二叉树时的标号无关，即若不重新对结点进行标号，则不能使用类似孩子结点编号是否为双亲结点编号的两倍等方法来判断完全二叉树。

### #15

右视图

Description

给出一个表示二叉树的字符串（根据满二叉树表示法，即空结点用-1表示），请从上到下输出从右侧能看到的二叉树结点。

![1668150805183.jpg](https://webvpn.fudan.edu.cn/http/77726476706e69737468656265737421a1a70fcd706726052746d8fdca/public/upload/b19cd502d2.jpg)

该二叉树转化成满二叉树表示法：1 2 3 -1 5 -1 4。

Input

输入为两行，第一行为二叉树的层数，层数不超过10；

第二行为该二叉树转化成满二叉树的表示法，用空格隔开。

Output

输出一行表示从上到下的二叉树的右视图，用空格隔开。

Sample Input 1 

```
3
1 2 3 -1 5 -1 4
```

Sample Output 1

```
1 3 4
```

### #16

**修路灯**

Description

台风过后，村里每条路上的路灯线路都被损坏，需要抢修，并且所有路灯抢修工作是同时进行的。

给出每条路连接的两个区域以及抢修这条路上路灯所需的时间，请输出最快需要多少时间，使得任意两个区域之间都至少存在一条路灯抢修完成的路（可以由多条路连成一条）。

Input

输入第一行为两个整数n和m，分别表示需要连接的区域数量和路的数量，n≤1000，m≤100000。

接下来n行，每行三个整数x，y，t，表示这条路连接x和y两个区域，在时间t可以抢修完成这条路上的路灯。x≤n，y≤n，0≤t≤100000。

Output

输出一行仅一个整数。如果全部路灯修复完成后，仍然有两个区域之间不存在路灯修好的路，则输出-1；否则输出最快需要多少时间。

Sample Input 1 

```
4 4
1 2 6
1 3 4
1 4 5
4 2 3
```

Sample Output 1

```
5
```

### #17

**小明的数字2**

Description

小武自从上次猜数字输给了小明之后一直想争口气，这回他趁刚学二叉树之际，向小明发起了新一轮的数字挑战。具体规则是，随机给定一颗完全二叉树，他们按照先序遍历的顺序，由小武开始，每人轮流从根节点到叶子节点的路线并计算这些数字按位拼接起来得到的一个值，最后看是小武手上这些值的总和和小明手里这些值的总和究竟谁的更大，就可以获胜！若两人的值相等也认为是小武获胜（谁定规则谁说了算）。

Input

先输入一个整数N (N<=1000)，代表树总共有N个节点，

接下来一行N个数，代表完全二叉树层序遍历的每个节点的值。

例如给定的树如下：

![0.png](https://webvpn.fudan.edu.cn/http/77726476706e69737468656265737421a1a70fcd706726052746d8fdca/public/upload/822ce82a3e.png)

\1) 小武先拿[1,3,4]组成数字134

\2) 小明拿[1,3,5]组成数字135

\3) 小武拿[1,2]组成数字12

小武拿到数字的总和为：134+12=146；小明拿到的数字总和为135，小武获胜。

Output

输出0代表小武获胜，1代表小明获胜。

Sample Input 1 

```
5
1 3 2 4 5
```

Sample Output 1

```
0
```

### #18

**小明的期中考试**

Description

小明期中考试遇到了一道字符串拼接的题目，在考场上百思不得其解，结果一回寝室就醍醐灌顶，他决定赶紧拿去考考小武。

给定两个字符串，输出第一个字符尾与第二个字符串头去重拼接后得到的新字符串。

Input

输入两行，一行一个字符串，字符串长度不超过10^5

Output

输出去重之后的字符串

Sample Input 1 

```
abcde
cdefg
```

Sample Output 1

```
abcdefg
```

### #19

**改作业**

Description

小明做助教要帮老师改作业，随机把所有作业分成n组，第i组中有z[i]份作业，需要在h小时内批改完成。

小明改作业的速度是k（单位：份/小时）。每个小时会选择一组作业，批改k份。如果这一组作业少于k份，小明在一个小时内改完，剩下时间休息，不会继续改，直到一小时结束，下一个小时开始改新的一组。

请返回小明可以在h小时内改完所有作业的最小速度k（k为整数）

Input

输入第一行m和h，m是一共有多少组作业，h是规定改作业的时间，m和h用空格隔开

1 <= m <= h <=10000

第二行是各个组作业的份数，用空格隔开

Output

返回整数的最小速度

Sample Input 1 

```
4 8
3 6 11 7
```

Sample Output 1

```
4
```

### #20

**小明送材料**

Description

小明送材料，大楼里有n个房间，小明按照制定路线要送n份材料。小明知道每个房间指定的签收时间段，也知道从一个房间到下一个所需要的距离。如果到达某个房间的时间早于最早签收时间，则必须等待至可以签收，但是不能超过最晚签收时间。可以认为签收过程不需要时间。

小明希望在所有材料送完的前提下，最大速度越小越好，请返回该最大速度最小是多少

Input

第 1 行为一个正整数n，表示房间数目。

下面n行，第i+1行有 3 个正整数xi,yi,si，表示按路线顺序给出第i个地点签收材料的时间段为[xi,yi]，即最早为距出发时刻xi，最晚为距出发时刻yi，从前一个房间到达第i个房间距离为si，且保证路线中xi递增。

可以认为s1为出发的地方到第1个地点的距离，且出发时刻为0。

n<=1000

xi, yi, si <=10000

Output

仅包括一个正数，最大速度最小值，结果保留两位小数。

Sample Input 1 

```
3
1 2 2
6 6 2
7 8 4
```

Sample Output 1

```
2.00
```

Hint

第一段用1的速度在时间2到达第1个房间，第二段用0.5的速度在时间6到达第2个房间，第三段用2的速度在时间8到达第3个房间。

### #21

**二叉搜索树**

Description

你需要设计一个二叉搜索树数据结构，它能够快速地进行插入和查找操作。

输入第一行包含一个整数n，表示接下来的操作数。

接下来的n行，每行包含两个整数op和val，其中：

op=1表示将val插入数据结构中，并保证插入后仍保持有序；

op=2表示查找val在数据结构中按照从小到大顺序的位置；

对于每个op=2的操作，输出一行，表示val在数据结构中的位置，如果val不存在，则输出-1。

Input

输入第一行包含一个整数n，表示接下来的操作数。

接下来的n行，每行包含两个整数op和val，其中op=1表示将val插入数据结构中，op=2表示查找val在数据结构中的位置。

输入保证所有val各不相同，位置序号从0开始。

Output

对于每个op=2的操作，输出一行，表示val在数据结构中的位置，如果val不存在，则输出-1。

Sample Input 1 

```
5
1 1
1 2
1 3
2 1
2 4
```

Sample Output 1

```
0
-1
```

### #22

**漫漫上学路**

Description

你现在在一座城市里，你的家在这座城市的某一个地方，在这座城市中间有许多个建筑物，每一个建筑物之间都有道路相连。但是，不同道路上的障碍数量是不同的，所以你想要知道从家到每一个建筑物，经过最少的障碍是多少。道路都是有向的。

Input

第一行包含三个整数n,m,s，分别表示建筑的个数、道路的个数、家的编号。

接下来m行每行包含三个整数u,v,w，表示一条u→v障碍数量为w的道路。

序号从1开始

点数不超过5000，边数不超过50000

Output

输出一行n个整数，第i个表示s到第i个点最少经过的障碍数，若不能到达则输出2147483647。

保证道路障碍总数不超过2147483647

Sample Input 1 

```
4 6 1
1 2 2
2 3 2
2 4 1
1 3 5
3 4 3
1 4 4
```

Sample Output 1

```
0 2 4 3
```

## Online Judge Test

### #a

**小明的数字终章**

Description

小明和小武在拿数字游戏上迎来了终章。他们的面前放着N张数字卡片，每张上写着一个数字，他们轮流选择当前所剩下的数字卡中最大的那一张拿掉（如果有两张数字一样都是最大的，也只能任取一张），最后看看他们手上各自的数字卡片的总和分别是多少。

为了比赛的绝对公平，这次决定如果所有卡片上数字的和为偶数就由小明先拿，如果是奇数就可以让小武先拿。

Input

先输入一个整数N(N<=10^5)，代表总共有N张卡片。

接下来一行N个数, 每个数x (0<=x<=3*10^5) 代表卡片上所写的数字。

Output

两个数。分别代表小明和小武手上数字卡片的总和

Sample Input 1 

```
5
1 2 3 4 5
```

Sample Output 1

```
6 9
```

### #b

**小明的派对**

Description

小明所在的村子有N个房子，这些房子和房子之间总共修了M条单向的路。小明住在1号房子，而小武住在N号房子，他们现在想选择除了他们家以外的N-2个房子中的一个开毕业派对，想请你帮他们选一下哪个房子能使得小明和小武到这个房子的最短走法的距离和最小呢？请给出两个人到这个房子的最短距离和。

Input

第一行两个数N，M，代表N个房子M条路径。(N<=5000, M<=50000)

接下来M行，每行三个数u, v, w代表有一条从u房子到v房子距离为w的路径

Output

输出小明和小武到选择开派对的房子的最短距离和。如果没有满足条件的房子，请输出-1.

Sample Input 1 

```
4 4
1 2 1
1 3 2
4 2 3
4 3 4
```

Sample Output 1

```
4
```

Hint

他们会选择在2号房子开派对，他们分别到2号房子的最短距离和为1+3=4.

### #c

**小明的迷宫**

Description

小明孤身前往了迷宫准备拯救小文和小武，他只能沿着上下左右的方向行走。

迷宫以矩形的形式给出，大小为N*M，但是迷宫中有一些障碍是小明无法到达的。

小明处在（1,1）的位置上，而小文和小武分别处在迷宫中的(x1, y1)和(x2, y2)的位置上，由于时间紧迫，小明只能选择小文和小武中的一人解救，他只能决定离他最短距离更近且确定能拯救到的那个人。

请问小明最短需要走多少距离才能拯救到这个人呢？

Input

第一行两个数N,M，代表迷宫的大小(N, M <= 20)

接下来N*M个字符，字符'.'代表迷宫可以经过的地方，字符'#'代表不可到达的障碍。

最后一行四个整数, x1, y1, x2, y2分别代表小文和小武的位置（下标从1开始）。

Output

如果能拯救到其中一个，请输出“Yes {distance}"，其中{distance} 代表小明需要拯救这个人走的最短距离。

如果小文和小武都拯救不到请输出“No”。

Sample Input 1 

```
3 3
.#.
...
.##
1 3 2 2
```

Sample Output 1

```
Yes 2
```

Hint

小文在（1,3）位置，小武在（2,2）位置，小明可以分别走4步和2步救到他们，他会选择走2步救小武
